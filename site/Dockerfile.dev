FROM rust:1.90

# Install dependencies
RUN rustup target add wasm32-unknown-unknown
RUN curl --proto '=https' --tlsv1.2 -LsSf https://github.com/leptos-rs/cargo-leptos/releases/download/v0.2.47/cargo-leptos-installer.sh | sh

# Install sass for styling
RUN apt-get update && apt-get install -y npm && npm install -g sass

WORKDIR /app

# Expose both the application port and hot-reload port
EXPOSE 3000
EXPOSE 3001

# Set environment variables for development
ENV RUST_LOG="debug"
ENV LEPTOS_SASS_VERSION=1.93.2

# Use cargo leptos watch for hot-reloading
CMD ["cargo", "leptos", "watch", "--hot-reload"]
